Implementation of the Viterbi algorithm (although we didn't know it at the time) using dynamic programming. 